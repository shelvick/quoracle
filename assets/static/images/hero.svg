<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 520" font-family="system-ui, -apple-system, sans-serif">
  <defs>
    <marker id="h-arr" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#64748b"/>
    </marker>
    <marker id="h-arr-accent" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#6366f1"/>
    </marker>
    <linearGradient id="h-root" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#6366f1"/>
      <stop offset="100%" stop-color="#4f46e5"/>
    </linearGradient>
    <linearGradient id="h-child" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#8b5cf6"/>
      <stop offset="100%" stop-color="#7c3aed"/>
    </linearGradient>
    <linearGradient id="h-grand" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#a78bfa"/>
      <stop offset="100%" stop-color="#8b5cf6"/>
    </linearGradient>
    <linearGradient id="h-winner" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="#6366f1"/>
      <stop offset="100%" stop-color="#8b5cf6"/>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="900" height="520" rx="12" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1"/>

  <!-- ============================================================ -->
  <!-- ROOT AGENT - large "open" box showing consensus inside       -->
  <!-- ============================================================ -->
  <rect x="180" y="20" width="540" height="200" rx="12" fill="url(#h-root)" opacity="0.08"/>
  <rect x="180" y="20" width="540" height="200" rx="12" fill="none" stroke="#6366f1" stroke-width="2"/>

  <!-- Root label -->
  <text x="210" y="48" font-size="14" font-weight="700" fill="#312e81">Root Agent</text>
  <text x="340" y="48" font-size="11" fill="#6366f1">"Project Manager"</text>

  <!-- Three model circles inside root -->
  <rect x="210" y="68" width="90" height="36" rx="6" fill="#fef3c7" stroke="#f59e0b" stroke-width="1.2"/>
  <text x="255" y="91" text-anchor="middle" font-size="10" font-weight="600" fill="#92400e">Model A</text>

  <rect x="210" y="114" width="90" height="36" rx="6" fill="#dbeafe" stroke="#3b82f6" stroke-width="1.2"/>
  <text x="255" y="137" text-anchor="middle" font-size="10" font-weight="600" fill="#1e3a8a">Model B</text>

  <rect x="210" y="160" width="90" height="36" rx="6" fill="#dcfce7" stroke="#22c55e" stroke-width="1.2"/>
  <text x="255" y="183" text-anchor="middle" font-size="10" font-weight="600" fill="#14532d">Model C</text>

  <!-- Fan-out arrows to clustering -->
  <line x1="300" y1="86" x2="340" y2="115" stroke="#94a3b8" stroke-width="1.2" marker-end="url(#h-arr)"/>
  <line x1="300" y1="132" x2="340" y2="132" stroke="#94a3b8" stroke-width="1.2" marker-end="url(#h-arr)"/>
  <line x1="300" y1="178" x2="340" y2="149" stroke="#94a3b8" stroke-width="1.2" marker-end="url(#h-arr)"/>

  <!-- Clustering box -->
  <rect x="345" y="105" width="90" height="55" rx="6" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="1.2"/>
  <text x="390" y="126" text-anchor="middle" font-size="10" font-weight="600" fill="#334155">Cluster</text>

  <!-- Mini cluster visualization -->
  <rect x="355" y="134" width="35" height="18" rx="3" fill="#eef2ff" stroke="#a5b4fc" stroke-width="0.8"/>
  <text x="372" y="147" text-anchor="middle" font-size="8" font-weight="600" fill="#4338ca">A+B</text>
  <rect x="394" y="134" width="30" height="18" rx="3" fill="#f8fafc" stroke="#e2e8f0" stroke-width="0.8"/>
  <text x="409" y="147" text-anchor="middle" font-size="8" fill="#94a3b8">C</text>

  <!-- Arrow to winner -->
  <line x1="435" y1="132" x2="470" y2="132" stroke="#6366f1" stroke-width="1.5" marker-end="url(#h-arr-accent)"/>

  <!-- Winner box -->
  <rect x="475" y="112" width="85" height="42" rx="6" fill="url(#h-winner)"/>
  <text x="517" y="131" text-anchor="middle" font-size="10" font-weight="700" fill="white">Consensus</text>
  <text x="517" y="146" text-anchor="middle" font-size="8" fill="#e0e7ff">spawn_child</text>

  <!-- Arrow to execute -->
  <line x1="560" y1="132" x2="595" y2="132" stroke="#6366f1" stroke-width="1.5" marker-end="url(#h-arr-accent)"/>

  <!-- Execute box -->
  <rect x="600" y="112" width="80" height="42" rx="6" fill="#ecfdf5" stroke="#34d399" stroke-width="1.2"/>
  <text x="640" y="131" text-anchor="middle" font-size="10" font-weight="600" fill="#065f46">Execute</text>
  <text x="640" y="146" text-anchor="middle" font-size="8" fill="#047857">action</text>

  <!-- Cycle arrow inside root -->
  <path d="M 640,155 Q 640,195 540,195 Q 440,195 440,160" fill="none" stroke="#94a3b8" stroke-width="1" stroke-dasharray="4,3" marker-end="url(#h-arr)"/>
  <text x="540" y="190" text-anchor="middle" font-size="8" fill="#94a3b8" font-style="italic">result loops back</text>

  <!-- ============================================================ -->
  <!-- SPAWN ARROWS from root to children                           -->
  <!-- ============================================================ -->
  <line x1="350" y1="220" x2="220" y2="292" stroke="#64748b" stroke-width="1.5" marker-end="url(#h-arr)"/>
  <line x1="550" y1="220" x2="680" y2="292" stroke="#64748b" stroke-width="1.5" marker-end="url(#h-arr)"/>

  <text x="270" y="260" text-anchor="middle" font-size="9" fill="#94a3b8" font-style="italic">spawn_child</text>
  <text x="630" y="260" text-anchor="middle" font-size="9" fill="#94a3b8" font-style="italic">spawn_child</text>

  <!-- ============================================================ -->
  <!-- CHILD AGENTS - smaller, with mini consensus indicators       -->
  <!-- ============================================================ -->

  <!-- Child A -->
  <rect x="80" y="297" width="280" height="80" rx="10" fill="url(#h-child)"/>
  <text x="130" y="322" font-size="12" font-weight="700" fill="white">Child Agent</text>
  <text x="253" y="322" font-size="10" fill="#ddd6fe">"Backend Engineer"</text>

  <!-- Mini consensus inside Child A -->
  <circle cx="115" cy="353" r="8" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/>
  <circle cx="137" cy="353" r="8" fill="#dbeafe" stroke="#3b82f6" stroke-width="1"/>
  <circle cx="159" cy="353" r="8" fill="#dcfce7" stroke="#22c55e" stroke-width="1"/>
  <line x1="170" y1="353" x2="193" y2="353" stroke="#94a3b8" stroke-width="1" marker-end="url(#h-arr)"/>
  <rect x="198" y="343" width="60" height="20" rx="4" fill="rgba(255,255,255,0.15)"/>
  <text x="228" y="357" text-anchor="middle" font-size="8" font-weight="600" fill="white">consensus</text>
  <line x1="260" y1="353" x2="280" y2="353" stroke="rgba(255,255,255,0.4)" stroke-width="1" marker-end="url(#h-arr)"/>
  <rect x="285" y="343" width="50" height="20" rx="4" fill="rgba(255,255,255,0.15)"/>
  <text x="310" y="357" text-anchor="middle" font-size="8" font-weight="600" fill="white">execute</text>

  <!-- Child B -->
  <rect x="540" y="297" width="280" height="80" rx="10" fill="url(#h-child)"/>
  <text x="590" y="322" font-size="12" font-weight="700" fill="white">Child Agent</text>
  <text x="710" y="322" font-size="10" fill="#ddd6fe">"Frontend Engineer"</text>

  <!-- Mini consensus inside Child B -->
  <circle cx="575" cy="353" r="8" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/>
  <circle cx="597" cy="353" r="8" fill="#dbeafe" stroke="#3b82f6" stroke-width="1"/>
  <circle cx="619" cy="353" r="8" fill="#dcfce7" stroke="#22c55e" stroke-width="1"/>
  <line x1="630" y1="353" x2="653" y2="353" stroke="#94a3b8" stroke-width="1" marker-end="url(#h-arr)"/>
  <rect x="658" y="343" width="60" height="20" rx="4" fill="rgba(255,255,255,0.15)"/>
  <text x="688" y="357" text-anchor="middle" font-size="8" font-weight="600" fill="white">consensus</text>
  <line x1="720" y1="353" x2="740" y2="353" stroke="rgba(255,255,255,0.4)" stroke-width="1" marker-end="url(#h-arr)"/>
  <rect x="745" y="343" width="50" height="20" rx="4" fill="rgba(255,255,255,0.15)"/>
  <text x="770" y="357" text-anchor="middle" font-size="8" font-weight="600" fill="white">execute</text>

  <!-- ============================================================ -->
  <!-- GRANDCHILD - spawn from Child A                              -->
  <!-- ============================================================ -->
  <line x1="220" y1="377" x2="220" y2="418" stroke="#64748b" stroke-width="1.5" marker-end="url(#h-arr)"/>
  <text x="245" y="403" font-size="9" fill="#94a3b8" font-style="italic">spawn_child</text>

  <rect x="100" y="423" width="240" height="65" rx="8" fill="url(#h-grand)"/>
  <text x="140" y="448" font-size="11" font-weight="600" fill="white">Grandchild</text>
  <text x="237" y="448" font-size="9" fill="#ede9fe">"Database Specialist"</text>

  <!-- Mini consensus inside Grandchild -->
  <circle cx="135" cy="472" r="7" fill="#fef3c7" stroke="#f59e0b" stroke-width="0.8"/>
  <circle cx="155" cy="472" r="7" fill="#dbeafe" stroke="#3b82f6" stroke-width="0.8"/>
  <circle cx="175" cy="472" r="7" fill="#dcfce7" stroke="#22c55e" stroke-width="0.8"/>
  <line x1="185" y1="472" x2="205" y2="472" stroke="#94a3b8" stroke-width="1" marker-end="url(#h-arr)"/>
  <rect x="210" y="463" width="55" height="18" rx="3" fill="rgba(255,255,255,0.15)"/>
  <text x="237" y="476" text-anchor="middle" font-size="8" font-weight="600" fill="white">consensus</text>
  <line x1="267" y1="472" x2="283" y2="472" stroke="rgba(255,255,255,0.4)" stroke-width="1" marker-end="url(#h-arr)"/>
  <rect x="288" y="463" width="40" height="18" rx="3" fill="rgba(255,255,255,0.15)"/>
  <text x="308" y="476" text-anchor="middle" font-size="8" font-weight="600" fill="white">execute</text>

  <!-- ============================================================ -->
  <!-- KEY / LEGEND                                                 -->
  <!-- ============================================================ -->
  <rect x="560" y="420" width="320" height="80" rx="8" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1"/>
  <text x="575" y="441" font-size="10" font-weight="700" fill="#334155">Every agent, at every level:</text>
  <text x="575" y="458" font-size="9" fill="#64748b">Multiple models independently propose each action.</text>
  <text x="575" y="472" font-size="9" fill="#64748b">Only the consensus action executes.</text>
  <text x="575" y="486" font-size="9" fill="#64748b">Results loop back for the next cycle.</text>
</svg>
